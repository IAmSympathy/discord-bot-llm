# ğŸ§© Ã‰vÃ©nement Ã‰nigme du Jour (Riddle)

## ğŸ“‹ Description

L'Ã©vÃ©nement **Ã‰nigme du Jour** est un Ã©vÃ©nement interactif d'une journÃ©e entiÃ¨re oÃ¹ Netricsa pose une Ã©nigme gÃ©nÃ©rÃ©e par IA. Tous les joueurs peuvent participer et ceux qui trouvent la rÃ©ponse gagnent de l'XP selon un systÃ¨me de leaderboard !

## âœ¨ FonctionnalitÃ©s

- ğŸ¤– **Ã‰nigmes gÃ©nÃ©rÃ©es par IA** (LLM) - Chaque Ã©nigme est unique !
- ğŸ”„ **Fallback automatique** sur 30+ Ã©nigmes prÃ©-Ã©crites si l'IA Ã©choue
- â° **DurÃ©e : 24 heures** - Toute une journÃ©e pour trouver la rÃ©ponse
- ğŸ† **SystÃ¨me de Leaderboard** - Tout le monde peut participer et gagner de l'XP
- ğŸ¯ **3 niveaux de difficultÃ©** : Facile, Moyen, Difficile
- ğŸ“š **7 catÃ©gories** : Logique, Jeux de mots, Nature, Objets, Gaming, Culture, MathÃ©matiques
- ğŸ’¡ **Indice automatique** aprÃ¨s 2 heures
- ğŸ **RÃ©compenses XP** basÃ©es sur la position dans le leaderboard
- âœ… **RÃ©ponses alternatives** acceptÃ©es

## ğŸ® Comment jouer

### DÃ©marrage

Quand l'Ã©vÃ©nement Ã‰nigme du Jour commence, un salon temporaire est crÃ©Ã© avec l'Ã©nigme gÃ©nÃ©rÃ©e par l'IA.

### Participer

1. Lisez l'Ã©nigme dans le salon dÃ©diÃ©
2. Tapez votre rÃ©ponse Ã  tout moment pendant les 24 heures
3. âœ… Bonne rÃ©ponse = Vous Ãªtes ajoutÃ© au leaderboard et gagnez de l'XP !
4. âŒ Mauvaise rÃ©ponse = Le bot rÃ©agit avec âŒ
5. ğŸ”„ Vous pouvez continuer Ã  essayer jusqu'Ã  trouver la bonne rÃ©ponse

### Indice

- Un indice apparaÃ®t automatiquement aprÃ¨s **2 heures**
- L'indice donne un coup de pouce sans rÃ©vÃ©ler la rÃ©ponse

### Fin de l'Ã©vÃ©nement

- â±ï¸ DurÃ©e : **24 heures** (toute une journÃ©e)
- ğŸ† Leaderboard final affichÃ© Ã  la fin
- ğŸ“Š La rÃ©ponse est rÃ©vÃ©lÃ©e avec le classement complet

## ğŸ’° RÃ©compenses XP (SystÃ¨me de Leaderboard)

| Position     | XP GagnÃ©             | Emoji |
|--------------|----------------------|-------|
| ğŸ¥‡ 1er       | 100% de l'XP de base | ğŸ¥‡    |
| ğŸ¥ˆ 2Ã¨me      | 70% de l'XP de base  | ğŸ¥ˆ    |
| ğŸ¥‰ 3Ã¨me      | 50% de l'XP de base  | ğŸ¥‰    |
| ğŸ–ï¸ Suivants | 30% de l'XP de base  | ğŸ–ï¸   |

**XP de base selon la difficultÃ© :**

- Facile : 100 XP (1er = 100 XP, 2Ã¨me = 70 XP, etc.)
- Moyen : 200 XP (1er = 200 XP, 2Ã¨me = 140 XP, etc.)
- Difficile : 300 XP (1er = 300 XP, 2Ã¨me = 210 XP, etc.)

ğŸ’¡ **Plus vous rÃ©pondez vite, mieux vous Ãªtes classÃ© !**

## ğŸ“š CatÃ©gories d'Ã©nigmes

1. **ğŸ§  Logique** - Ã‰nigmes de rÃ©flexion
2. **ğŸ”¤ Jeux de mots** - Ã‰nigmes sur les lettres et mots
3. **ğŸŒ³ Nature** - Ã‰nigmes sur la nature
4. **ğŸ“¦ Objets** - Ã‰nigmes sur des objets du quotidien
5. **ğŸ® Gaming** - Ã‰nigmes sur les jeux vidÃ©o
6. **ğŸŒ Culture** - Culture gÃ©nÃ©rale
7. **ğŸ”¢ MathÃ©matiques** - Ã‰nigmes mathÃ©matiques

## ğŸ§ª Tester l'Ã©vÃ©nement

En tant que propriÃ©taire du bot, utilisez :

```
/test-event type:ğŸ§© Ã‰nigme
```

Le mode test :

- âœ… CrÃ©e l'Ã©vÃ©nement normalement
- âœ… Fonctionne comme en production
- âŒ **Aucun XP n'est distribuÃ©**
- ğŸ“ MarquÃ© "MODE TEST" dans le footer

## ğŸ“ Exemples d'Ã©nigmes

### GÃ©nÃ©rÃ©es par l'IA ğŸ¤–

L'IA (Ollama) gÃ©nÃ¨re des Ã©nigmes originales Ã  chaque Ã©vÃ©nement. Exemples de ce que l'IA peut crÃ©er :

> **Question :** Je vole sans ailes, je pleure sans yeux. Partout oÃ¹ je vais, l'obscuritÃ© me suit. Qui suis-je ?  
> **RÃ©ponse :** Nuage  
> **Indice :** â˜ï¸ Regarde vers le ciel lors d'un jour de pluie.

> **Question :** Plus on m'utilise, plus je deviens propre. Qui suis-je ?  
> **RÃ©ponse :** Savon  
> **Indice :** ğŸ§¼ Tu m'utilises pour te laver les mains.

### Base de donnÃ©es de fallback ğŸ“š

Si l'IA Ã©choue, le systÃ¨me utilise des Ã©nigmes prÃ©-Ã©crites :

#### Facile ğŸŸ¢

> **Question :** Plus je sÃ¨che, plus je deviens mouillÃ©. Qui suis-je ?  
> **RÃ©ponse :** Serviette  
> **Indice :** ğŸ› On l'utilise aprÃ¨s la douche.

#### Moyen ğŸŸ¡

> **Question :** Plus tu m'enlÃ¨ves, plus je deviens grand. Qui suis-je ?  
> **RÃ©ponse :** Trou  
> **Indice :** ğŸ•³ï¸ Creuse, creuse, et tu verras grandir...

#### Difficile ğŸ”´

> **Question :** Je suis au dÃ©but de l'Ã©ternitÃ©, Ã  la fin du temps et de l'espace. Je suis au dÃ©but de chaque fin et Ã  la fin de chaque place. Qui suis-je ?  
> **RÃ©ponse :** E (la lettre)  
> **Indice :** ğŸ”¤ Cherche la lettre commune dans ces mots.

## ğŸ”§ FonctionnalitÃ©s techniques

### RÃ©ponses flexibles

Le systÃ¨me accepte plusieurs variantes de rÃ©ponses :

```typescript
{
    answer: "serviette",
        alternativeAnswers
:
    ["une serviette", "la serviette", "torchon"]
}
```

### Normalisation

- Les rÃ©ponses sont comparÃ©es en **minuscules**
- Les espaces en dÃ©but/fin sont **supprimÃ©s**
- Les articles (le, la, un, une) sont **optionnels**

### Validation instantanÃ©e

- âœ… Bonne rÃ©ponse â†’ Embed de victoire + XP
- âŒ Mauvaise rÃ©ponse â†’ RÃ©action âŒ
- ğŸ¤– Le bot ne rÃ©pond pas â†’ Pas d'Ã©vÃ©nement actif

## ğŸ“Š Statistiques

L'Ã©vÃ©nement enregistre :

- ğŸ‘¥ **Participants** : Liste des userId qui ont tentÃ©
- ğŸ† **Gagnant** : L'userId du gagnant (si trouvÃ©)
- â±ï¸ **Temps** : Temps pris pour rÃ©soudre
- ğŸ’¡ **Indice** : Si l'indice a Ã©tÃ© montrÃ©

## ğŸ¨ Personnalisation

### Modifier les paramÃ¨tres de gÃ©nÃ©ration LLM

Ã‰ditez `src/services/events/riddleLLMGenerator.ts` :

```typescript
// TempÃ©rature (crÃ©ativitÃ©) : 0.7 = conservateur, 1.2 = trÃ¨s crÃ©atif
temperature: 0.9,

// Longueur de la rÃ©ponse
    num_predict
:
300
```

### Ajouter des Ã©nigmes de fallback

Ã‰ditez `src/services/events/riddleData.ts` :

```typescript
{
    id: 'riddle_custom_1',
        question
:
    "Votre question ici ?",
        answer
:
    "reponse",
        alternativeAnswers
:
    ["autre rÃ©ponse", "variante"],
        hint
:
    "ğŸ’¡ Votre indice ici",
        difficulty
:
    'moyen',
        category
:
    'Logique',
        xpReward
:
    200
}
```

### Modifier les durÃ©es

Dans `riddleEvent.ts` :

```typescript
const RIDDLE_DURATION = 24 * 60 * 60 * 1000; // 24 heures
const HINT_DELAY = 2 * 60 * 60 * 1000; // Indice aprÃ¨s 2 heures
```

### Ajuster les rÃ©compenses du leaderboard

Dans `riddleEvent.ts`, fonction `handleRiddleMessage` :

```typescript
let xpMultiplier: number;
if (position === 1) xpMultiplier = 1.0; // 100%
else if (position === 2) xpMultiplier = 0.7; // 70%
else if (position === 3) xpMultiplier = 0.5; // 50%
else xpMultiplier = 0.3; // 30% pour les suivants
```

## ğŸŒŸ Ã‰nigmes spÃ©ciales

### Ã‰nigmes Sherbrooke ğŸ‡¨ğŸ‡¦

Ã‰nigmes sur la ville de Sherbrooke et le QuÃ©bec :

- "Quel est le surnom de Sherbrooke ?"
- "Combien de riviÃ¨res traversent Sherbrooke ?"

### Ã‰nigmes Gaming ğŸ®

Pour les gamers :

- Questions sur Mario, Minecraft, etc.
- RÃ©compenses bonus

## ğŸ”® DÃ©veloppement futur

IdÃ©es pour amÃ©liorer l'Ã©vÃ©nement :

- âœ… ~~Mode "Ã‰nigme du jour" rÃ©currente~~ **ImplÃ©mentÃ©!**
- âœ… ~~Leaderboard des meilleurs rÃ©solveurs~~ **ImplÃ©mentÃ©!**
- âœ… ~~Ã‰nigmes gÃ©nÃ©rÃ©es par IA~~ **ImplÃ©mentÃ©!**
- ğŸŒˆ Variante "Emoji MystÃ¨re" avec des Ã©mojis
- ğŸ”Š Ã‰nigmes vocales
- ğŸ–¼ï¸ Ã‰nigmes visuelles avec images
- ğŸ¯ Ã‰nigmes en Ã©quipe
- ğŸ“Š Statistiques de performance par joueur
- ğŸ¨ ThÃ¨mes d'Ã©nigmes (Halloween, NoÃ«l, etc.)

## ğŸ› DÃ©pannage

### L'Ã©vÃ©nement ne dÃ©marre pas

- VÃ©rifier qu'il n'y a pas dÃ©jÃ  un Ã©vÃ©nement actif
- VÃ©rifier les permissions du bot (Manage Channels)
- VÃ©rifier qu'Ollama est dÃ©marrÃ© et accessible

### Les rÃ©ponses ne sont pas dÃ©tectÃ©es

- VÃ©rifier que le salon est bien celui de l'Ã©vÃ©nement
- Les messages du bot sont ignorÃ©s automatiquement
- Les utilisateurs qui ont dÃ©jÃ  trouvÃ© ne reÃ§oivent plus de rÃ©action

### L'indice n'apparaÃ®t pas

- Il apparaÃ®t aprÃ¨s 2 heures
- VÃ©rifier les logs pour voir si l'indice a Ã©tÃ© envoyÃ©

### L'IA ne gÃ©nÃ¨re pas d'Ã©nigmes

- VÃ©rifier qu'Ollama est en cours d'exÃ©cution
- Le systÃ¨me passe automatiquement en mode fallback (Ã©nigmes prÃ©-Ã©crites)
- VÃ©rifier les logs avec `[RiddleLLMGenerator]`

---

**Amusez-vous bien avec les Ã©nigmes ! ğŸ§©**

